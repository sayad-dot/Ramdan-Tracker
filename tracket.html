<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>Ramadan Tracker 1446H</title>
<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0a0e1a;
    --card: #111827;
    --card2: #1a2236;
    --gold: #d4a843;
    --gold2: #f0c96a;
    --teal: #2dd4bf;
    --text: #e8e8f0;
    --muted: #6b7a99;
    --done: #22c55e;
    --border: rgba(212,168,67,0.2);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Poppins', sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* stars bg */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background: 
      radial-gradient(ellipse at 20% 20%, rgba(212,168,67,0.05) 0%, transparent 60%),
      radial-gradient(ellipse at 80% 80%, rgba(45,212,191,0.04) 0%, transparent 60%);
    pointer-events: none;
    z-index: 0;
  }

  .stars {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 0;
    overflow: hidden;
  }

  .star {
    position: absolute;
    background: white;
    border-radius: 50%;
    animation: twinkle var(--d) ease-in-out infinite;
  }

  @keyframes twinkle {
    0%, 100% { opacity: 0.1; }
    50% { opacity: 0.8; }
  }

  .app {
    position: relative;
    z-index: 1;
    max-width: 430px;
    margin: 0 auto;
    padding-bottom: 100px;
  }

  /* Header */
  header {
    text-align: center;
    padding: 36px 20px 20px;
    position: relative;
  }

  .crescent {
    font-size: 42px;
    display: block;
    filter: drop-shadow(0 0 20px rgba(212,168,67,0.6));
    animation: float 3s ease-in-out infinite;
  }

  @keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-6px); }
  }

  .app-title {
    font-family: 'Amiri', serif;
    font-size: 28px;
    color: var(--gold);
    letter-spacing: 1px;
    margin-top: 6px;
    text-shadow: 0 0 30px rgba(212,168,67,0.4);
  }

  .app-sub {
    font-size: 12px;
    color: var(--muted);
    letter-spacing: 3px;
    text-transform: uppercase;
    margin-top: 2px;
  }

  /* Progress ring */
  .progress-section {
    padding: 10px 20px 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 12px;
  }

  .ring-wrapper {
    position: relative;
    width: 130px;
    height: 130px;
  }

  .ring-wrapper svg {
    transform: rotate(-90deg);
  }

  .ring-center {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }

  .ring-pct {
    font-size: 26px;
    font-weight: 600;
    color: var(--gold);
  }

  .ring-label {
    font-size: 10px;
    color: var(--muted);
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .month-progress {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 13px;
    color: var(--muted);
  }

  .month-progress strong {
    color: var(--gold2);
  }

  /* Day selector */
  .day-selector {
    padding: 0 20px;
    margin-bottom: 16px;
  }

  .day-label {
    font-size: 11px;
    color: var(--muted);
    text-transform: uppercase;
    letter-spacing: 2px;
    margin-bottom: 10px;
  }

  .days-grid {
    display: grid;
    grid-template-columns: repeat(10, 1fr);
    gap: 5px;
  }

  .day-btn {
    aspect-ratio: 1;
    border-radius: 8px;
    border: 1px solid var(--border);
    background: var(--card);
    color: var(--muted);
    font-size: 11px;
    font-family: 'Poppins', sans-serif;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 500;
  }

  .day-btn.active {
    background: var(--gold);
    color: #0a0e1a;
    border-color: var(--gold);
    font-weight: 600;
    box-shadow: 0 0 12px rgba(212,168,67,0.4);
  }

  .day-btn.complete {
    background: rgba(34,197,94,0.15);
    border-color: rgba(34,197,94,0.4);
    color: var(--done);
  }

  .day-btn.partial {
    background: rgba(212,168,67,0.1);
    border-color: rgba(212,168,67,0.3);
    color: var(--gold);
  }

  /* Tasks */
  .tasks-section {
    padding: 0 20px;
  }

  .day-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 14px;
  }

  .day-title {
    font-family: 'Amiri', serif;
    font-size: 20px;
    color: var(--gold);
  }

  .day-score {
    font-size: 12px;
    background: var(--card2);
    padding: 4px 12px;
    border-radius: 20px;
    color: var(--muted);
    border: 1px solid var(--border);
  }

  .day-score span {
    color: var(--gold2);
    font-weight: 600;
  }

  .category-title {
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 2px;
    color: var(--muted);
    margin: 16px 0 8px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .category-title::after {
    content: '';
    flex: 1;
    height: 1px;
    background: var(--border);
  }

  .task-card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 14px 16px;
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 14px;
    cursor: pointer;
    transition: all 0.25s cubic-bezier(0.34, 1.56, 0.64, 1);
    user-select: none;
    -webkit-user-select: none;
  }

  .task-card:active {
    transform: scale(0.97);
  }

  .task-card.done {
    background: rgba(34,197,94,0.08);
    border-color: rgba(34,197,94,0.3);
  }

  .task-icon {
    width: 42px;
    height: 42px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    background: rgba(212,168,67,0.1);
    flex-shrink: 0;
    transition: transform 0.3s;
  }

  .task-card.done .task-icon {
    background: rgba(34,197,94,0.15);
  }

  .task-card.done .task-icon {
    animation: pop 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  @keyframes pop {
    0% { transform: scale(0.8); }
    100% { transform: scale(1); }
  }

  .task-info {
    flex: 1;
  }

  .task-name {
    font-size: 15px;
    font-weight: 500;
    color: var(--text);
    transition: color 0.2s;
  }

  .task-card.done .task-name {
    color: var(--done);
  }

  .task-sub {
    font-size: 11px;
    color: var(--muted);
    margin-top: 1px;
  }

  .check {
    width: 26px;
    height: 26px;
    border-radius: 50%;
    border: 2px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    transition: all 0.25s;
    background: transparent;
  }

  .task-card.done .check {
    background: var(--done);
    border-color: var(--done);
  }

  .check::after {
    content: '';
    width: 10px;
    height: 6px;
    border-left: 2px solid white;
    border-bottom: 2px solid white;
    transform: rotate(-45deg) translateY(-1px);
    opacity: 0;
    transition: opacity 0.2s;
  }

  .task-card.done .check::after {
    opacity: 1;
  }

  /* Bottom nav */
  .bottom-nav {
    position: fixed;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 100%;
    max-width: 430px;
    background: rgba(10,14,26,0.95);
    backdrop-filter: blur(20px);
    border-top: 1px solid var(--border);
    padding: 12px 0 20px;
    z-index: 100;
  }

  .nav-inner {
    display: flex;
    justify-content: space-around;
  }

  .nav-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    background: none;
    border: none;
    color: var(--muted);
    font-family: 'Poppins', sans-serif;
    font-size: 10px;
    cursor: pointer;
    padding: 4px 16px;
    border-radius: 8px;
    transition: all 0.2s;
  }

  .nav-btn.active {
    color: var(--gold);
  }

  .nav-icon {
    font-size: 22px;
  }

  /* Overview screen */
  .screen { display: none; }
  .screen.active { display: block; }

  .overview-grid {
    padding: 0 20px;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-bottom: 20px;
  }

  .stat-card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 16px;
    text-align: center;
  }

  .stat-val {
    font-size: 28px;
    font-weight: 600;
    color: var(--gold);
    font-family: 'Amiri', serif;
  }

  .stat-lbl {
    font-size: 11px;
    color: var(--muted);
    margin-top: 2px;
  }

  .heatmap {
    padding: 0 20px;
  }

  .heatmap-title {
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 2px;
    color: var(--muted);
    margin-bottom: 10px;
  }

  .heatmap-grid {
    display: grid;
    grid-template-columns: repeat(10, 1fr);
    gap: 5px;
  }

  .hmap-cell {
    aspect-ratio: 1;
    border-radius: 6px;
    background: var(--card);
    border: 1px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
    color: var(--muted);
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
  }

  .hmap-cell:active { transform: scale(0.92); }

  /* Toast */
  .toast {
    position: fixed;
    bottom: 90px;
    left: 50%;
    transform: translateX(-50%) translateY(20px);
    background: var(--done);
    color: white;
    padding: 10px 20px;
    border-radius: 24px;
    font-size: 13px;
    font-weight: 500;
    opacity: 0;
    transition: all 0.3s;
    pointer-events: none;
    z-index: 200;
    white-space: nowrap;
  }

  .toast.show {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }

  .ayah {
    margin: 0 20px 16px;
    background: var(--card);
    border: 1px solid var(--border);
    border-left: 3px solid var(--gold);
    border-radius: 12px;
    padding: 14px 16px;
  }

  .ayah-arabic {
    font-family: 'Amiri', serif;
    font-size: 18px;
    color: var(--gold2);
    text-align: right;
    line-height: 1.8;
    direction: rtl;
  }

  .ayah-trans {
    font-size: 11px;
    color: var(--muted);
    margin-top: 6px;
    line-height: 1.6;
    font-style: italic;
  }

  .section-header {
    padding: 20px 20px 10px;
  }

  .section-heading {
    font-family: 'Amiri', serif;
    font-size: 22px;
    color: var(--gold);
  }
</style>
</head>
<body>

<div class="stars" id="stars"></div>

<div class="app">
  <!-- TODAY SCREEN -->
  <div class="screen active" id="screen-today">
    <header>
      <span class="crescent">‚òΩ</span>
      <div class="app-title">ÿ±ŸÖÿ∂ÿßŸÜ ŸÉÿ±ŸäŸÖ</div>
      <div class="app-sub">Ramadan Tracker 1446H</div>
    </header>

    <div class="progress-section">
      <div class="ring-wrapper">
        <svg width="130" height="130" viewBox="0 0 130 130">
          <circle cx="65" cy="65" r="54" fill="none" stroke="rgba(212,168,67,0.1)" stroke-width="10"/>
          <circle id="progress-ring" cx="65" cy="65" r="54" fill="none" stroke="url(#goldGrad)" stroke-width="10"
            stroke-linecap="round" stroke-dasharray="339.3" stroke-dashoffset="339.3"
            style="transition: stroke-dashoffset 0.5s ease;"/>
          <defs>
            <linearGradient id="goldGrad" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" stop-color="#d4a843"/>
              <stop offset="100%" stop-color="#f0c96a"/>
            </linearGradient>
          </defs>
        </svg>
        <div class="ring-center">
          <div class="ring-pct" id="ring-pct">0%</div>
          <div class="ring-label">Today</div>
        </div>
      </div>
      <div class="month-progress">
        Day <strong id="cur-day-label">1</strong> of Ramadan &nbsp;¬∑&nbsp; <strong id="month-done">0</strong>/30 days tracked
      </div>
    </div>

    <div class="day-selector">
      <div class="day-label">Select Day</div>
      <div class="days-grid" id="days-grid"></div>
    </div>

    <div class="tasks-section">
      <div class="day-header">
        <div class="day-title" id="day-title">Day 1</div>
        <div class="day-score"><span id="score-num">0</span>/10 done</div>
      </div>

      <div class="ayah">
        <div class="ayah-arabic">ÿ¥ŸéŸáŸíÿ±Ÿè ÿ±ŸéŸÖŸéÿ∂ŸéÿßŸÜŸé ÿßŸÑŸéŸëÿ∞ŸêŸä ÿ£ŸèŸÜÿ≤ŸêŸÑŸé ŸÅŸêŸäŸáŸê ÿßŸÑŸíŸÇŸèÿ±Ÿíÿ¢ŸÜŸè</div>
        <div class="ayah-trans">"The month of Ramadan in which was revealed the Quran..." ‚Äî Al-Baqarah 2:185</div>
      </div>

      <div id="tasks-list"></div>
    </div>
  </div>

  <!-- OVERVIEW SCREEN -->
  <div class="screen" id="screen-overview">
    <div class="section-header">
      <span class="crescent" style="font-size:28px;">‚òΩ</span>
      <div class="section-heading">30-Day Overview</div>
    </div>

    <div class="overview-grid" id="stats-grid"></div>

    <div class="heatmap">
      <div class="heatmap-title">Completion Heatmap</div>
      <div class="heatmap-grid" id="heatmap-grid"></div>
    </div>
  </div>
</div>

<!-- Bottom Nav -->
<div class="bottom-nav">
  <div class="nav-inner">
    <button class="nav-btn active" id="nav-today" onclick="switchScreen('today')">
      <span class="nav-icon">üåô</span>
      Today
    </button>
    <button class="nav-btn" id="nav-overview" onclick="switchScreen('overview')">
      <span class="nav-icon">üìä</span>
      Overview
    </button>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
const TASKS = [
  { id: 'fajr',       name: 'Fajr',        icon: 'üåÖ', sub: 'Dawn prayer', cat: 'Prayers' },
  { id: 'dhuhr',      name: 'Dhuhr',       icon: '‚òÄÔ∏è', sub: 'Midday prayer', cat: 'Prayers' },
  { id: 'asr',        name: 'Asr',         icon: 'üå§Ô∏è', sub: 'Afternoon prayer', cat: 'Prayers' },
  { id: 'maghrib',    name: 'Maghrib',     icon: 'üåá', sub: 'Sunset prayer', cat: 'Prayers' },
  { id: 'isha',       name: 'Isha',        icon: 'üåÉ', sub: 'Night prayer', cat: 'Prayers' },
  { id: 'fast',       name: 'Fast',        icon: 'ü§≤', sub: 'Completed the fast', cat: 'Fasting' },
  { id: 'taraweeh',   name: 'Taraweeh',   icon: 'üïå', sub: 'Night prayers', cat: 'Night Worship' },
  { id: 'tahajjud',   name: 'Tahajjud',   icon: '‚≠ê', sub: 'Late night prayer', cat: 'Night Worship' },
  { id: 'quran',      name: 'Quran Recite',icon: 'üìñ', sub: 'Quran recitation', cat: 'Ibadah' },
  { id: 'istighfar',  name: 'Istighfar',  icon: 'üí´', sub: 'Seeking forgiveness', cat: 'Ibadah' },
  { id: 'sadaqah',    name: 'Sadaqah',    icon: 'üíõ', sub: 'Charity / good deed', cat: 'Ibadah' },
];

const TOTAL = TASKS.length;
let currentDay = 1;
// data[day] = Set of task ids
let data = {};

function loadData() {
  try {
    const saved = localStorage.getItem('ramadan1446');
    if (saved) {
      const raw = JSON.parse(saved);
      for (let k in raw) data[k] = new Set(raw[k]);
    }
  } catch(e) {}
}

function saveData() {
  const raw = {};
  for (let k in data) raw[k] = [...data[k]];
  try { localStorage.setItem('ramadan1446', JSON.stringify(raw)); } catch(e) {}
}

function getDayData(d) {
  if (!data[d]) data[d] = new Set();
  return data[d];
}

function toggleTask(taskId) {
  const daySet = getDayData(currentDay);
  if (daySet.has(taskId)) {
    daySet.delete(taskId);
  } else {
    daySet.add(taskId);
    showToast(TASKS.find(t=>t.id===taskId).name + ' ‚úì');
  }
  saveData();
  renderTasks();
  renderDaysGrid();
  updateRing();
  if (document.getElementById('screen-overview').classList.contains('active')) renderOverview();
}

function renderTasks() {
  const daySet = getDayData(currentDay);
  const score = daySet.size;

  document.getElementById('day-title').textContent = `Day ${currentDay}`;
  document.getElementById('score-num').textContent = score;

  const cats = [...new Set(TASKS.map(t => t.cat))];
  let html = '';
  for (const cat of cats) {
    html += `<div class="category-title">${cat}</div>`;
    for (const task of TASKS.filter(t => t.cat === cat)) {
      const done = daySet.has(task.id);
      html += `
        <div class="task-card ${done ? 'done' : ''}" onclick="toggleTask('${task.id}')">
          <div class="task-icon">${task.icon}</div>
          <div class="task-info">
            <div class="task-name">${task.name}</div>
            <div class="task-sub">${task.sub}</div>
          </div>
          <div class="check"></div>
        </div>`;
    }
  }
  document.getElementById('tasks-list').innerHTML = html;
}

function renderDaysGrid() {
  const grid = document.getElementById('days-grid');
  let html = '';
  for (let d = 1; d <= 30; d++) {
    const ds = getDayData(d);
    let cls = '';
    if (d === currentDay) cls = 'active';
    else if (ds.size === TOTAL) cls = 'complete';
    else if (ds.size > 0) cls = 'partial';
    html += `<button class="day-btn ${cls}" onclick="selectDay(${d})">${d}</button>`;
  }
  grid.innerHTML = html;

  let doneCount = 0;
  for (let d = 1; d <= 30; d++) {
    if (getDayData(d).size > 0) doneCount++;
  }
  document.getElementById('month-done').textContent = doneCount;
  document.getElementById('cur-day-label').textContent = currentDay;
}

function updateRing() {
  const daySet = getDayData(currentDay);
  const pct = daySet.size / TOTAL;
  const circ = 2 * Math.PI * 54;
  const offset = circ * (1 - pct);
  document.getElementById('progress-ring').style.strokeDashoffset = offset;
  document.getElementById('ring-pct').textContent = Math.round(pct * 100) + '%';
}

function selectDay(d) {
  currentDay = d;
  renderDaysGrid();
  renderTasks();
  updateRing();
}

function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 1800);
}

function switchScreen(name) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('screen-' + name).classList.add('active');
  document.getElementById('nav-' + name).classList.add('active');
  if (name === 'overview') renderOverview();
}

function renderOverview() {
  // stats
  let totalChecks = 0, perfectDays = 0, activeDays = 0;
  let prayerDone = 0;
  for (let d = 1; d <= 30; d++) {
    const ds = getDayData(d);
    totalChecks += ds.size;
    if (ds.size === TOTAL) perfectDays++;
    if (ds.size > 0) activeDays++;
    // count all 5 prayers done
    if (['fajr','dhuhr','asr','maghrib','isha'].every(p => ds.has(p))) prayerDone++;
  }
  const maxPossible = 30 * TOTAL;
  const overallPct = maxPossible > 0 ? Math.round((totalChecks / maxPossible) * 100) : 0;

  document.getElementById('stats-grid').innerHTML = `
    <div class="stat-card"><div class="stat-val">${overallPct}%</div><div class="stat-lbl">Overall Progress</div></div>
    <div class="stat-card"><div class="stat-val">${perfectDays}</div><div class="stat-lbl">Perfect Days ‚≠ê</div></div>
    <div class="stat-card"><div class="stat-val">${activeDays}</div><div class="stat-lbl">Days Tracked</div></div>
    <div class="stat-card"><div class="stat-val">${prayerDone}</div><div class="stat-lbl">Full Prayer Days</div></div>
  `;

  // heatmap
  const colors = ['#1a2236', '#3b2a0a', '#7a5c10', '#c49130', '#d4a843', '#f0c96a'];
  let hmHtml = '';
  for (let d = 1; d <= 30; d++) {
    const ds = getDayData(d);
    const lvl = Math.min(5, Math.floor((ds.size / TOTAL) * 5));
    const bg = colors[lvl];
    const isActive = d === currentDay ? 'border:2px solid #f0c96a;' : '';
    hmHtml += `<div class="hmap-cell" style="background:${bg};${isActive}" onclick="goToDay(${d})" title="Day ${d}: ${ds.size}/${TOTAL}">${d}</div>`;
  }
  document.getElementById('heatmap-grid').innerHTML = hmHtml;
}

function goToDay(d) {
  currentDay = d;
  switchScreen('today');
  renderDaysGrid();
  renderTasks();
  updateRing();
}

// Generate stars
function makeStars() {
  const el = document.getElementById('stars');
  for (let i = 0; i < 60; i++) {
    const s = document.createElement('div');
    s.className = 'star';
    const size = Math.random() * 2 + 1;
    s.style.cssText = `
      width:${size}px; height:${size}px;
      left:${Math.random()*100}%;
      top:${Math.random()*100}%;
      --d:${2+Math.random()*3}s;
      animation-delay:${Math.random()*3}s;
    `;
    el.appendChild(s);
  }
}

// Init
loadData();
makeStars();
renderDaysGrid();
renderTasks();
updateRing();
</script>
</body>
</html>